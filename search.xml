<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>移动端测试学习（三）</title>
      <link href="2020/10/22/yi-dong-duan-ce-shi-xue-xi-san/"/>
      <url>2020/10/22/yi-dong-duan-ce-shi-xue-xi-san/</url>
      
        <content type="html"><![CDATA[<h2 id="一、ADB-简介"><a href="#一、ADB-简介" class="headerlink" title="一、ADB 简介"></a>一、ADB 简介</h2><p>ADB 即 Android Debug Bridge，Android 调试桥的缩写，ADB 是一个 C / S 架构的命令行工具，主要由 3 部分组成：</p><p>1）运行在 PC 端的 Client，可以通过它对 Android 应用进行安装、卸载及调试。</p><pre><code>注意：1）Eclipse 中的 ADT、SDK Tools 目录下的 DDMS、Monitor 等工具，都是同样地用到了 ADB 的功能来与 Android 设备进行交互。2）PC 端的手机助手，诸如 360 手机助手、豌豆荚、应用宝等，其除了安装第三方应用方便，其他的功能，基本上都可以通过 ADB 命令去完成，这里建议测试人员尽量不要在电脑上安装这类手机助手，因为其自带的 ADB 程序可能会与 Android SDK 下的 ADB 程序产生冲突，5037端口被占用，导致使用 ADB 命令时无法连接到设备。</code></pre><p>2）运行在 PC 端的 Service，其管理客户端到 Android 设备上 ADB 后台进程的连接。</p><pre><code>注意：1）ADB 服务启动后，Windows 可以在任务管理器中找到 adb.exe 这个进程。</code></pre><p>3）运行在 Android 设备上的 ADB 后台进程。</p><pre><code>注意：1）执行 adb shell ps | grep adbd ，可以找到该后台进程，windows 请使用 findstr 替代 grep2）ADB 的使用端口号为5037</code></pre><h2 id="二、为什么使用-ADB"><a href="#二、为什么使用-ADB" class="headerlink" title="二、为什么使用 ADB"></a>二、为什么使用 ADB</h2><p>现有 Android 系统的权限机制越来越完善，很多希望能够绕开权限管理机制进行的一些操作都已经无法使用，但是 ADB 却可以实现，实际上 ADB 在某种程度上有很大权限的，即使是在最新版本的 Android 系统上，因为 ADB 的设计初衷是为了方便开发人员调试，因此必然需要暴露一些权限以外的接口，于是很多公司利用这个特性可以绕开权限机制在非 Root 非定制机上做一些操作（具体用法就是下面说的这些），当然方式也是五花八门，比如通过手机 OTG 连接，这里不再赘述，通过 ADB 命令协助开发人员在开发 Android 应用的过程中更快更好的调试 APK，因此 ADB 具有安装卸载 APK、拷贝推送文件、查看设备硬件信息、查看应用程序占用资源、在设备执行 shell 命令等功能。</p><h2 id="三、ADB-命令"><a href="#三、ADB-命令" class="headerlink" title="三、ADB 命令"></a>三、ADB 命令</h2><h3 id="3-1-设备管理"><a href="#3-1-设备管理" class="headerlink" title="3.1 设备管理"></a>3.1 设备管理</h3><ul><li><strong>adb devices</strong></li></ul><p>测试过程中，我们可以通过 adb devices 获取设备列表及设备状态。</p><pre><code># 获取设备列表及设备状态adb devices</code></pre><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022161109661.png" alt="image-20201022161109661"></p><p>另外，也可用 ADB 命令管理多台设备</p><pre><code># 管理多台设备adb [-e | -d | -s &lt;设备序列号&gt;] &lt;子命令&gt;</code></pre><ul><li><strong>adb root / adb remount</strong></li></ul><p>获取 root 权限，一般 adb root 和 adb remount 一起使用，未获取权限前，使用 adb shell 看到的用户信息符号为 $ 符号，获取 root 权限后，看到的用户信息符号为 # 符号。</p><pre><code># 获取 root 权限adb rootadb remount</code></pre><ul><li><strong>adb get-state</strong></li></ul><p>获取设备的状态，其中设备的状态有3种，device：设备正常连接，offline：连接出现异常，设备无响应，unknown：没有连接设备。</p><pre><code># 获取设备的状态adb get-state</code></pre><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022161601674.png" alt="image-20201022161601674"></p><h3 id="3-2-安装-卸载应用"><a href="#3-2-安装-卸载应用" class="headerlink" title="3.2 安装/卸载应用"></a>3.2 安装/卸载应用</h3><ul><li><strong>adb install [apk 路径] / adb uninstall [apk 包名]</strong></li></ul><p>安装应用 / 卸载应用，覆盖安装是使用 -r 选项，载时保存数据和缓存目录是使用 -k 选项。</p><pre><code># 安装应用adb install [apk 路径]adb install -r [apk 路径]# 卸载应用adb uninstall [apk 包名]adb uninstall -k [apk 包名]</code></pre><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022163303606.png" alt="image-20201022163303606"></p><p>adb uninstall 涉及到包名的查看，因此这里先不做演示。</p><h3 id="3-3-文件管理"><a href="#3-3-文件管理" class="headerlink" title="3.3 文件管理"></a>3.3 文件管理</h3><ul><li><strong>adb push [本地路径] [Android 设备路径] / adb pull [Android 设备路径] [本地路径]</strong></li></ul><p>将本地文件放入 Android 设备，将 Android 设备文件取出。</p><pre><code># 将本地文件放入 Android 设备adb push [本地路径] [Android 设备路径]# 将 Android 设备文件取出adb pull [Android 设备路径] [本地路径]</code></pre><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022171255161.png" alt="image-20201022171255161"></p><h3 id="3-4-设备重启"><a href="#3-4-设备重启" class="headerlink" title="3.4 设备重启"></a>3.4 设备重启</h3><ul><li><strong>adb reboot</strong></li></ul><p>重启设备</p><pre><code># 重启设备，进入 fastboot 模式adb reboot-bootloader# 重启设备，进入 recovery 模式adb reboot-recovery</code></pre><h2 id="四、ADB-LOGCAT-命令"><a href="#四、ADB-LOGCAT-命令" class="headerlink" title="四、ADB LOGCAT 命令"></a>四、ADB LOGCAT 命令</h2><p>在移动端测试中，用得比较多的，应该是 adb logcat 命令，使用 adb logcat 命令显示 Android 设备上的 log 日志，我们通常需要通过 adb logcat 这个命令去定位某些问题，例如产品在使用过程中突然 crash，或者抓取缺陷复现过程中的 log 等。</p><p>首先，可以通过 adb logcat -help 获取 logcat 命令使用帮助，查看 logcat 都有哪些用法：</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022174841959.png" alt="image-20201022174841959"></p><p>下面简单介绍几个用的比较多的抓取 log 的命令：</p><p>1）adb logcat -v time &gt; log.txt：打印日志详细时间，并保存在本地的 log.txt 文件中。</p><p>2）adb logcat -v time <em>:E：</em>打印时间和级别是 Error 的日志。</p><p>3）adb logcat | grep keyword：过滤关键字以外数据。</p><p>4）adb logcat -c：清除日志。</p><p>5）adb logcat -t 5：显示最后五条。</p><h2 id="五、ADB-SHELL-命令"><a href="#五、ADB-SHELL-命令" class="headerlink" title="五、ADB SHELL 命令"></a>五、ADB SHELL 命令</h2><p>什么是 adb shell 命令？首先我们要知道，Android 是基于 Linux 的自由及开放源代码的操作系统，因此，Linux 中的 shell 命令在 Android 中也是适用的，也就是所谓的 adb shell 命令，adb shell 命令都以二进制的形式存放在 Android 中的 system/bin 文件夹下，接下来看一下有哪些常用的 adb shell 命令。</p><ul><li>adb shell cat /proc/meminfo    查看内存信息</li><li>adb shell cat /proc/cpuinfo    查看 cpu 信息</li><li>adb shell dumpsys activity    列出设备上的 activity 栈和任务的信息，还有其他组件的一些信息和一些关于进程的信息。</li><li>adb shell dumpsys packages    列出一些系统信息和所有应用的信息。</li><li>adb shell pm list permissions     列出目标平台上的所有权限。</li><li>adb shell pm list packages    列出目标设备上安装的所有 app 的包名。</li><li>adb shell pm list features    列出目标设备上的所有 feature。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 移动端测试学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件测试 </tag>
            
            <tag> 移动端测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移动端测试学习（一）</title>
      <link href="2020/10/22/yi-dong-duan-ce-shi-xue-xi-yi/"/>
      <url>2020/10/22/yi-dong-duan-ce-shi-xue-xi-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="一、UI测试"><a href="#一、UI测试" class="headerlink" title="一、UI测试"></a>一、UI测试</h2><p>UI 测试的目的是确保软件的各个页面的布局、样式是否与原型设计稿相符。</p><h2 id="二、业务功能测试"><a href="#二、业务功能测试" class="headerlink" title="二、业务功能测试"></a>二、业务功能测试</h2><p>这里说的大多数指黑盒测试，目的是检查程序功能是否按照需求文档的要求，业务功能测试包括了功能点测试、业务逻辑测试、关联性测试：</p><p>1）功能点测试：以产品功能需求文档等作为依据，测试产品各个模块的功能点是否正常。</p><p>2）业务逻辑测试：检查业务逻辑是否正常。</p><p>3）关联性测试：与 PC 端的交互情况。</p><h2 id="三、兼容性测试"><a href="#三、兼容性测试" class="headerlink" title="三、兼容性测试"></a>三、兼容性测试</h2><p>兼容性测试涉及到了测试设备的系统版本、分辨率、机型，这些都可以根据实际软件用户占比进行调整。</p><h2 id="四、稳定性测试"><a href="#四、稳定性测试" class="headerlink" title="四、稳定性测试"></a>四、稳定性测试</h2><p>稳定性测试，目的是保证程序能够长时间稳定运行，该测试通过随机或固定的操作，看看产品会不会出现 carsh 或者是内存溢出现象（类似压力测试），一般常用测试工具有 Monkey 等，测试方法例如：</p><p>1）断电、断网等情况操作。</p><p>2）待机、插拔数据线等。</p><p>3）编写 Monkey 命令，通过 logcat 定位问题。</p><h2 id="四、易用性测试"><a href="#四、易用性测试" class="headerlink" title="四、易用性测试"></a>四、易用性测试</h2><p>易用性测试关注的是人机交互的情况，包括了产品的可用性，界面交互性，用户体验等：</p><p>1）产品可用性测试：使用产品的错误率、操作是否简单等。</p><p>2）界面交互性：是否使用是否方便、是否符合交互规范等。</p><p>3）用户体验：以主观的普通消费者的角度去感知产品或服务的舒适、有用、易用、友好亲切程度，通过不同个体、独立空间和非经验的统计复用方式去有效评价产品的体验特性提出修改意见提升产品的潜在客户满意度。</p><h2 id="五、性能测试"><a href="#五、性能测试" class="headerlink" title="五、性能测试"></a>五、性能测试</h2><p>性能测试包括接口性能、CPU、内存、启动时间、访问速度、流量、耗电等测试点。</p><h2 id="六、安全性测试"><a href="#六、安全性测试" class="headerlink" title="六、安全性测试"></a>六、安全性测试</h2><p>安全性的测试包括对软件权限的检查、安装与卸载的安全性、数据安全性、通讯安全性、人机接口安全性等。</p><h2 id="七、其他测试"><a href="#七、其他测试" class="headerlink" title="七、其他测试"></a>七、其他测试</h2><p>1）安装卸载升级测试</p><p>2）网络环境测试：wifi / 2G / 3G / 4G / 5G，net / wap，电信 / 移动 / 联通。</p><p>3）手势操作测试</p><p>4）回归测试</p><p>5）交叉事件测试：针对智能终端应用的服务等级划分方式及实时特性所提出的测试方法，交叉测试又叫事件或冲突测试，是指一个功能正在执行过程中，同时另外一个事件或操作对该过程进行干扰的测试，如：App 在前 / 后台运行状态时与来电、文件下载、音乐收听等关键运用的交互情况测试等，交叉事件测试非常重要，能发现很多应用中潜在的性能问题。</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20201022141141004.png" alt="image-20201022141141004"></p>]]></content>
      
      
      <categories>
          
          <category> 移动端测试学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件测试 </tag>
            
            <tag> 移动端测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>移动端测试学习（二）</title>
      <link href="2020/10/22/yi-dong-duan-ce-shi-xue-xi-er/"/>
      <url>2020/10/22/yi-dong-duan-ce-shi-xue-xi-er/</url>
      
        <content type="html"><![CDATA[<h2 id="一、Java-环境搭建"><a href="#一、Java-环境搭建" class="headerlink" title="一、Java 环境搭建"></a>一、Java 环境搭建</h2><h2 id="二、Android-SDK-环境搭建"><a href="#二、Android-SDK-环境搭建" class="headerlink" title="二、Android SDK 环境搭建"></a>二、Android SDK 环境搭建</h2><h2 id="三、Android-模拟器下载"><a href="#三、Android-模拟器下载" class="headerlink" title="三、Android 模拟器下载"></a>三、Android 模拟器下载</h2>]]></content>
      
      
      <categories>
          
          <category> 移动端测试学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软件测试 </tag>
            
            <tag> 移动端测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Selenium for Java（一）</title>
      <link href="2020/10/20/selenium-for-java-yi/"/>
      <url>2020/10/20/selenium-for-java-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="一、Selenium-概述"><a href="#一、Selenium-概述" class="headerlink" title="一、Selenium 概述"></a>一、Selenium 概述</h2><h3 id="1-1-Selenium-发展史"><a href="#1-1-Selenium-发展史" class="headerlink" title="1.1 Selenium 发展史"></a>1.1 Selenium 发展史</h3><p>Selenium 是一系列基于 Web 的自动化工具，提供一套测试函数，用于支持 Web 自动化测试。函数非常灵活，能够完成界面元素定位、窗口跳转、结果比较，具有如下特点：</p><ul><li>多浏览器支持：如 IE、Firefox、Chrome、Safari、Android 手机浏览器等。</li><li>多语言支持：如 Java、Python、PHP、C# 等。</li><li>多操作系统支持：如 Windows、Linux、IOS、Android等。</li><li>开源免费：<a href="http://www.seleniumhg.org/">Selenium 官网地址</a></li></ul><p>Selenium 框架由多个工具组成，包括：Selenium IDE，Selenium RC，Selenium WebDriver 和 SeleniumRC。</p><p>发展到如今 Selenium 已经发布到了 3.0+ 版本了，以下是简单总结发展过程以及一些变化：</p><ul><li>Selenium 1.0</li></ul><p>Jason Huggins 在2004年发起的 Selenium 项目，使用 JavaScript 编写的一个类库，这个 JavaScript 类库就是 Selenium core，同时也是 seleniumRC、Selenium IDE 的核心组件，Selenium由此诞生。</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930091535768.png" alt="image-20200930091535768"></p><ul><li>Selenium 2.0</li></ul><p>因为 Selenium 和 Webdriver 的合并，所以，Selenium 2.0 由此诞生，简单用公式表示为：Selenium 2.0 = Selenium 1.0 + WebDriver，需要强调的是，在Selenium 2.0 中主推的是 WebDriver，可以将其看作 Selenium RC 的替代品，因为 Selenium 为了保持向下的兼容性，所以在 Selenium 2.0 中并没有彻底地抛弃Selenium RC，所以，我们在学习 Selenium2.0 的时候，核心是学习 WebDriver，它的工作原理是这样的：</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930091703173.png" alt="image-20200930091703173"></p><ul><li>Selenium 3.0</li></ul><p>Selenium 3.0 做了一些不大不小的更新：</p><p>1）终于去掉了 RC，简单用公式表示为：Selenium 3.0 = Selenium 2.0 - Selenium RC（Remote Control）。</p><p>2）Selenium3.0 只支持 Java8 版本以上。</p><p>3）Selenium3.0 中 Firefox 浏览器驱动独立了，以前装完 Selenium2 就可以驱动 Firefox 浏览器了，现在和 Chrome 一样，必须下载和设置浏览器驱动。</p><p>4）MAC OS 集成 Safari 的浏览器驱动，默认在 /usr/bin/safaridriver 目录下。</p><p>5）只支持 IE 9.0 版本以上。</p><h3 id="1-2-Selenium-原理"><a href="#1-2-Selenium-原理" class="headerlink" title="1.2 Selenium 原理"></a>1.2 Selenium 原理</h3><p>将 WebDriver 驱动浏览器类比成开出租车的场景：</p><p>在开出租车时有三个角色：</p><ul><li><strong>乘客：</strong>他/她告诉出租车司机去哪里，大概怎么走。</li><li><strong>出租车司机：</strong>他按照乘客的要求来操控出租车。</li><li><strong>出租车：</strong>出租车按照司机的操控完成真正的行驶，把乘客送到目的地。</li></ul><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930092023197.png" alt="image-20200930092023197"></p><p>在 WebDriver 中也有类似的三个角色：</p><ul><li><strong>工程师写的自动化测试代码</strong>：自动化测试代码发送请求给浏览器的驱动（比如火狐驱动、谷歌驱动）</li><li><strong>浏览器的驱动</strong>：它来解析这些自动化测试的代码，解析后把它们发送给浏览器</li><li><strong>浏览器</strong>：执行浏览器驱动发来的指令，并最终完成工程师想要的操作。</li></ul><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930092056580.png" alt="image-20200930092056580"></p><h2 id="二、Selenium-环境搭建"><a href="#二、Selenium-环境搭建" class="headerlink" title="二、Selenium 环境搭建"></a>二、Selenium 环境搭建</h2><h3 id="2-1-Java-环境"><a href="#2-1-Java-环境" class="headerlink" title="2.1 Java 环境"></a>2.1 Java 环境</h3><p>想要通过 java 语言来使用 selenium 框架，前提要完成 jdk 环境的安装。</p><p>详细安装教程见：<a href="https://blog.csdn.net/shengmer/article/details/78836255">JDK 下载安装教程</a></p><h3 id="2-2-Selenium-环境"><a href="#2-2-Selenium-环境" class="headerlink" title="2.2 Selenium 环境"></a>2.2 Selenium 环境</h3><p>Selenium 在 Java 中的使用主要有两种：</p><p>1）简单 Java 工程</p><p>下载对应的版本 jar 包，然后直接导入 selenium 的 jar 包就可以了。</p><p>jar 包下载地址：<a href="https://npm.taobao.org/mirrors/selenium">Selenium jar 包下载</a></p><p>2）Maven 工程</p><p>首先创建一个 Maven 工程，然后在 pom.xml 文件中添加 Selenium 依赖即可。</p><p>详细安装教程见：<a href="https://www.cnblogs.com/xihehua/p/9639045.html">Maven 下载安装教程</a></p><pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.seleniumhq.selenium<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>selenium-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.4.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></code></pre><h3 id="2-3-Selenium-驱动包"><a href="#2-3-Selenium-驱动包" class="headerlink" title="2.3 Selenium 驱动包"></a>2.3 Selenium 驱动包</h3><p>当 selenium 升级到3.0之后，对不同的浏览器驱动进行了规范，如果想使用 selenium 驱动不同的浏览器，必须单独下载并设置不同的浏览器驱动。</p><p>各浏览器下载地址：</p><ul><li>Firefox浏览器驱动：<a href="https://github.com/mozilla/geckodriver/releases">Firefox 驱动下载地址</a></li><li>Chrome浏览器驱动：<a href="https://sites.google.com/a/chromium.org/chromedriver/home">Chrome 驱动下载地址</a></li><li>Edge浏览器驱动：<a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/">Edge 驱动下载地址</a></li></ul><p><strong>设置浏览器驱动</strong></p><p>设置浏览器的地址非常简单，我们可以手动创建一个存放浏览器驱动的目录，如： C:\driver , 将下载的浏览器驱动文件丢到该目录下。</p><p>我的电脑 –&gt; 属性 –&gt; 系统设置 –&gt; 高级 –&gt; 环境变量 –&gt; 系统变量 –&gt; Path，将“C:\driver”目录添加到 Path 的值中。</p><h2 id="三、Selenium-简单例子"><a href="#三、Selenium-简单例子" class="headerlink" title="三、Selenium 简单例子"></a>三、Selenium 简单例子</h2><p>首先，先写一个简单的例子来验证一下环境是否配置成功（这里使用 Maven 工程进行操作）</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo01</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 1. 引入本地浏览器驱动</span>        System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 2. 创建 webDriver 驱动</span>        WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 3. 打开百度首页</span>        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 4. 获取输入框，输入 selenium</span>        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"selenium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 5. 获取“百度一下”按钮，点击搜索</span>        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 6. 退出浏览器</span>        webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>运行代码，若能成功打开浏览器，并执行相应的操作，则证明环境已经配置完成，另外，解释一下以上代码，首先，需要将本地的浏览器驱动.exe 文件引用进来，之后创建一个 webDriver 驱动，调用 webdriver 封装好的方法去获取需要打开的页面，以及相应的执行操作。</p>]]></content>
      
      
      <categories>
          
          <category> Selenium for Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web 自动化测试 </tag>
            
            <tag> 软件测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Selenium for Java（二）</title>
      <link href="2020/10/20/selenium-for-java-er/"/>
      <url>2020/10/20/selenium-for-java-er/</url>
      
        <content type="html"><![CDATA[<h2 id="一、Selenium-定位"><a href="#一、Selenium-定位" class="headerlink" title="一、Selenium 定位"></a>一、Selenium 定位</h2><h3 id="1-1-定位方式"><a href="#1-1-定位方式" class="headerlink" title="1.1 定位方式"></a>1.1 定位方式</h3><p><strong>selenium 提供了8种的定位方式：</strong></p><ul><li>id</li><li>name</li><li>class name</li><li>tag name</li><li>link text</li><li>partial link text</li><li>xpath</li><li>css selector</li></ul><p>这8种定位方式在 java selenium 中对应的方法为：</p><table><thead><tr><th>方法</th><th>描述</th><th>参数</th><th>示例</th></tr></thead><tbody><tr><td>findElement(By.id())</td><td>通过元素的 id 属性值来定位元素</td><td>对应的 id 属性值</td><td>findElement(By.id(“kw”))</td></tr><tr><td>findElement(By.name())</td><td>通过元素的 name 属性值来定位元素</td><td>对应的 name 值</td><td>findElement(By.name(“user”))</td></tr><tr><td>findElement(By.className())</td><td>通过元素的 class 名来定位元素</td><td>对应的 class 类名</td><td>findElement(By.className(“passworld”))</td></tr><tr><td>findElement(By.tagName())</td><td>通过元素的 tag 标签名来定位元素</td><td>对应的标签名</td><td>findElement(By.tagName(“input”))</td></tr><tr><td>findElement(By.linkText())</td><td>通过元素标签对之间的文本信息来定位元素</td><td>文本内容</td><td>findElement(By.linkText(“登录”))</td></tr><tr><td>findElement(By.partialLinkText())</td><td>通过元素标签对之间的部分文本信息来定位元素</td><td>部分文本内容</td><td>findElement(By.partialLinkText(“百度”))</td></tr><tr><td>findElement(By.xpath())</td><td>通过 xpath 语法来定位元素</td><td>xpath 表达式</td><td>findElement(By.xpath(“//input[@id=’kw’]”))</td></tr><tr><td>findElement(By.cssSelector())</td><td>通过 css 选择器来定位元素</td><td>css 元素选择器</td><td>findElement(By.cssSelector(“#kw”))</td></tr></tbody></table><p>同时这8种方法都对应有着返回复数元素的方法，分别在调用的方法 findElements(By.id())  加上一个 s：</p><ul><li>findElements(By.id())</li><li>findElements(By.name())</li><li>findElements(By.className())</li><li>findElements(By.tagName())</li><li>findElements(By.linkText())</li><li>findElements(By.partialLinkText())</li><li>findElements(By.xpath())</li><li>findElements(By.cssSelector())</li></ul><h3 id="1-2-定位方式用法"><a href="#1-2-定位方式用法" class="headerlink" title="1.2 定位方式用法"></a>1.2 定位方式用法</h3><p>例如，我们的目的是要定位百度页面的 input 标签的输入框：</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930111415110.png" alt="image-20200930111415110"></p><p>1）id</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>2）name</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"wd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>3）class name</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">className</span><span class="token punctuation">(</span><span class="token string">"s_ipt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>4）tag name</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">tagName</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>5）xpath，写法多种</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//*[@id='kw']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> id定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//*[@name='wd']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 属性值定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//span[text()='按钮']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 文本定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//input[@class='s_ipt']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> <span class="token keyword">class</span>属性定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"/html/body/form/span/input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 绝对路径定位</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//span[@class='soutu-btn']/input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 相对路径定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//form[@id='form']/span/input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//input[@id='kw' and @name='wd']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 多组合属性定位webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//span[contains(text(),'按钮')]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span><span class="token operator">/</span> 是否包含文本</code></pre><p>6）css，写法多种</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// id定位</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"[name=wd]"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// name属性值定位</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">".s_ipt"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// class地位</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"html > body > form > span > input"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// css层级定位</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"span.soutu-btn> input#kw"</span><span class="token punctuation">)</span> webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"form#form > span > input"</span><span class="token punctuation">)</span></code></pre><p>7）linkText</p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930111819363.png" alt="image-20200930111819363"></p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span><span class="token string">"新闻"</span><span class="token punctuation">)</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span><span class="token string">"hao123"</span><span class="token punctuation">)</span></code></pre><p>8）partialLinkText</p><pre class=" language-java"><code class="language-java">webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">partialLinkText</span><span class="token punctuation">(</span><span class="token string">"新"</span><span class="token punctuation">)</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">partialLinkText</span><span class="token punctuation">(</span><span class="token string">"hao"</span><span class="token punctuation">)</span>webdriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">partialLinkText</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span></code></pre><h2 id="二、Selenium-API"><a href="#二、Selenium-API" class="headerlink" title="二、Selenium API"></a>二、Selenium API</h2><h3 id="2-1-webdriver-常用-API"><a href="#2-1-webdriver-常用-API" class="headerlink" title="2.1 webdriver 常用 API"></a>2.1 webdriver 常用 API</h3><p>WebDriver 提供了一系列的 API 来和浏览器进行交互，如下：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>get(String url）</td><td>访问目标 url 地址，打开网页</td></tr><tr><td>getCurrentUrl()</td><td>获取当前页面 url 地址</td></tr><tr><td>getTitle()</td><td>获取页面标题</td></tr><tr><td>getPageSource()</td><td>获取页面源代码</td></tr><tr><td>close()</td><td>关闭浏览器当前打开的窗口</td></tr><tr><td>quit()</td><td>关闭浏览器所有的窗口</td></tr><tr><td>findElement(by)</td><td>查找单个元素</td></tr><tr><td>findElements(by)</td><td>查到元素列表，返回一个集合</td></tr><tr><td>getWindowHandle()</td><td>获取当前窗口句柄</td></tr><tr><td>getWindowHandles()</td><td>获取所有窗口的句柄</td></tr></tbody></table><h3 id="2-2-webelement-常用-API"><a href="#2-2-webelement-常用-API" class="headerlink" title="2.2 webelement 常用 API"></a>2.2 webelement 常用 API</h3><p> 通过 webelement 实现与网站页面上元素的交互，这些元素包含文本框、文本域、按钮、单选框等，WebElement 提供了一系列的方法对这些元素进行操作：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>click()</td><td>对元素进行点击</td></tr><tr><td>clear()</td><td>清空内容（如文本框内容）</td></tr><tr><td>sendKeys(…)</td><td>写入内容与模拟按键操作</td></tr><tr><td>isDisplayed()</td><td>元素是否可见（true：可见，false：不可见）</td></tr><tr><td>isEnabled()</td><td>元素是否启用</td></tr><tr><td>isSelected()</td><td>元素是否已选择</td></tr><tr><td>getTagName()</td><td>获取元素标签名</td></tr><tr><td>getAttribute(attributeName)</td><td>获取元素对应的属性值</td></tr><tr><td>getText()</td><td>获取元素文本值（元素可见状态下才能获取到）</td></tr><tr><td>submit()</td><td>表单提交</td></tr></tbody></table><h3 id="2-3-简单演示"><a href="#2-3-简单演示" class="headerlink" title="2.3 简单演示"></a>2.3 简单演示</h3><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebElement<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo02</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 引入本地浏览器驱动</span>        System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 创建 webDriver 驱动</span>        WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 打开百度首页</span>        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 获取输入框，输入 selenium</span>        WebElement inputElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// clear()方法，清空输入框内容</span>        inputElement<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// sendKeys()方法，在搜索框中输入搜索内容</span>        inputElement<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"selenium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 元素是否显示</span>        <span class="token keyword">boolean</span> displayed <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">isDisplayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>displayed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出true</span>        <span class="token comment" spellcheck="true">// 元素是否启用</span>        <span class="token keyword">boolean</span> enabled <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>enabled<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出true</span>        <span class="token comment" spellcheck="true">// 判断元素是否被选中状态，一般用在Radio(单选),Checkbox（多选）,Select（下拉选）</span>        <span class="token comment" spellcheck="true">// 在输入框中使用无意义</span>        <span class="token keyword">boolean</span> selected <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">isSelected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>selected<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出fasle</span>        <span class="token comment" spellcheck="true">// 获取标签名</span>        String tagName <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">getTagName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>tagName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出input</span>        <span class="token comment" spellcheck="true">// 获取属性名(name属性)</span>        String name <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出wd</span>        <span class="token comment" spellcheck="true">// 获取文本值</span>        String text <span class="token operator">=</span> inputElement<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 输出selenium</span>        <span class="token comment" spellcheck="true">// 通过submit提交</span>        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// click()方法，点击百度一下按钮</span><span class="token comment" spellcheck="true">//        webDriver.findElement(By.id("su")).click();</span>        <span class="token comment" spellcheck="true">// 退出浏览器</span>        webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h2 id="三、等待机制"><a href="#三、等待机制" class="headerlink" title="三、等待机制"></a>三、等待机制</h2><p>在对元素进行定位时，有时候网页加载时间比较长，元素还没有加载出来，这个时候去查找这个元素的话程序中就会抛出异常，所以我们在编写代码时需要考虑延时问题，在 selenium 中有几种延时机制可以使用如下：</p><h3 id="3-1-强制等待"><a href="#3-1-强制等待" class="headerlink" title="3.1 强制等待"></a>3.1 强制等待</h3><p>硬性等待就是不管你浏览器元素是否加载完成，都要进行等待设置好的时间，利用 Java 中的线程类 Thread 中的 sleep 方法，进行强制等待。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebElement<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo03</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebElement inputElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        inputElement<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"selenium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebElement btnElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        btnElement<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 强制等待 5 秒后关闭浏览器</span>        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>这种方法在一定的程度是可以解决元素加载过慢的情况，但是不建议使用该方法，因为一般情况下我们无法判断网页到底需要多长时间加载完成，如果我们设置的时间过长，非常影响效率。</p><h3 id="3-2-隐式等待"><a href="#3-2-隐式等待" class="headerlink" title="3.2 隐式等待"></a>3.2 隐式等待</h3><p> 隐式等待的理解，就是我们通过代码设置一个等待时间，如果在这个等待时间内，网页加载完成后就执行下一步，否则一直等待到时间截止。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebElement<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>TimeUnit<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo03</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 隐式等待 5 秒后打开百度页面</span>        webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">timeouts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">implicitlyWait</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> TimeUnit<span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span>        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebElement inputElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        inputElement<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"selenium"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        WebElement btnElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        btnElement<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>这种方法相对于硬性等待显的会灵活一点，但是隐式等待也有个弊端，因为这个设置是全局的，也就是说需要等待整个页面加载完成，但有时候需要找的那个元素早就加载完成了，只是个别其他元素加载比较慢，那么，就不能马上进行下一步操作，而是会一直等待下去，直到所有的元素加载完成后才执行。</p><h3 id="3-3-显式等待"><a href="#3-3-显式等待" class="headerlink" title="3.3 显式等待"></a>3.3 显式等待</h3><p>显示等待是等待指定元素设置的等待时间，在设置时间内，默认每隔 0.5s 检测一次当前的页面这个元素是否存在，如果在规定的时间内找到了元素则执行相关操作，如果超过设置时间检测不到则抛出异常，默认抛出异常为：NoSuchElementException，推荐使用显示等待。</p><pre class=" language-java"><code class="language-java">WebDriberWait wait <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebDriverWait</span><span class="token punctuation">(</span>dirver<span class="token punctuation">,</span> timeOutInSeconds<span class="token punctuation">)</span><span class="token punctuation">;</span>wait<span class="token punctuation">.</span><span class="token function">nutil</span><span class="token punctuation">(</span>expectCondition<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>具体使用案例：</p><p>1.查找元素是否已经加载出来</p><pre class=" language-java"><code class="language-java">WebDriverWait wait <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 查找id为“kw"的元素是否加载出来了（已经在页面DOM中存在）</span>wait<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>ExpectedConditions<span class="token punctuation">.</span><span class="token function">presenceOfElementLocated</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>2.查找元素是否可见</p><pre class=" language-java"><code class="language-java">WebDriverWait wait <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 查找id为"kw"的元素是否可见</span>wait<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>ExpectedConditions<span class="token punctuation">.</span><span class="token function">visibilityOfElementLocated</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>3.查找元素是否可点击</p><pre class=" language-java"><code class="language-java">WebDriverWait wait <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 查找id为"kw"的元素是否可以点击</span>wait<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>ExpectedConditions<span class="token punctuation">.</span><span class="token function">elementToBeClickable</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>4.自定义方法，重写 ExpectedCondition 中的 apply 方法</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*自定义查找元素的方法，对元素查找方法进行二次封装，更加的灵活，可以加上自己逻辑。*/</span><span class="token keyword">public</span> WebElement <span class="token function">getElement</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeOutInSecond<span class="token punctuation">,</span> By by<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        WebDriverWait wait <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> timeOutInSecond<span class="token punctuation">)</span><span class="token punctuation">;</span>        WebElement element <span class="token operator">=</span> wait<span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExpectedCondition</span><span class="token operator">&lt;</span>WebElement<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token annotation punctuation">@NullableDecl</span>            <span class="token annotation punctuation">@Override</span>            <span class="token keyword">public</span> WebElement <span class="token function">apply</span><span class="token punctuation">(</span><span class="token annotation punctuation">@NullableDecl</span> WebDriver webDriver<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> element<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="3-4-ExpectedConditions类中常用方法"><a href="#3-4-ExpectedConditions类中常用方法" class="headerlink" title="3.4 ExpectedConditions类中常用方法"></a>3.4 ExpectedConditions类中常用方法</h3><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>presenceOfElementLocated(By locator)</td><td>判断某个元素是否被加到了 dom 树里，并不代表该元素一定可见</td></tr><tr><td>visibilityOfElementLocated(By locator)</td><td>判断某个元素是否可见（代表元素非隐藏，元素的宽和高都不等于0）</td></tr><tr><td>elementToBeClickable(By locator)</td><td>判断某个元素中是否可见并且是 enable 的且可点击</td></tr><tr><td>elementToBeSelected(By locator)</td><td>判断某个元素是否被选中了，一般用在下拉列表</td></tr><tr><td>alertIsPresent()</td><td>判断页面上是否存在 alert</td></tr><tr><td>titleIs(String title)</td><td>判断当前页面的 title 是否精确等于预期</td></tr><tr><td>titleContains(String title)</td><td>判断当前页面的 title 是否包含预期字符串</td></tr><tr><td>textToBePresentInElement(By locator, String text)</td><td>判断某个元素中的 text 是否包含了预期的字符串</td></tr><tr><td>textToBePresentInElementValue(By locator, String text)</td><td>判断某个元素中的 value 属性是否包含了预期的字符串</td></tr><tr><td>invisibilityOfElementLocated(By locator)</td><td>判断某个元素中是否不存在于 dom 树或不可见</td></tr><tr><td>frameToBeAvailableAndSwitchToIt(By)</td><td>判断 iframe 可用，并且切换到 iframe 中</td></tr></tbody></table><h3 id="3-5-页面加载超时设置"><a href="#3-5-页面加载超时设置" class="headerlink" title="3.5 页面加载超时设置"></a>3.5 页面加载超时设置</h3><p>通过 TimeOuts 对象进行全局页面加载超时的设置，该设置必须放置 get 方法之前，如下代码：</p><pre><code>driver.manage().timeouts().pageLoadTimeout(5, TimeUnit.SECONDS);driver.get(&quot;https://www.baidu.com&quot;);</code></pre><p>若首页在超过5秒钟没有加载完毕，程序就会抛出异常，如果在2秒就加载完了，就直接往下执行，如果需要对页面加载时间有要求的，可以用这个设置进行检验。</p><h2 id="四、特殊元素操作"><a href="#四、特殊元素操作" class="headerlink" title="四、特殊元素操作"></a>四、特殊元素操作</h2><h3 id="4-1-弹出框处理（alert、confirm）"><a href="#4-1-弹出框处理（alert、confirm）" class="headerlink" title="4.1 弹出框处理（alert、confirm）"></a>4.1 弹出框处理（alert、confirm）</h3><p>操作 alert、confirm 弹出框，可以通过 Alert 对象来进行操作，Alert 类包含了确认、取消、输入和获取弹出窗内容。</p><p>Alert 对应属性和方法：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>Alert.getText()</td><td>获取弹出框内容。</td></tr><tr><td>Alert.accept()</td><td>接受弹窗的提示，相当于点击确认按钮。</td></tr><tr><td>Alert.dismiss()</td><td>取消提示窗。</td></tr><tr><td>Alert.sendKeys(String s)</td><td>给弹窗输入内容。</td></tr></tbody></table><p>简单使用示例：</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 首先需要切换到弹出框中，获取Alert对象。</span>Alert alert <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 获取弹窗文本内容</span>alert<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 点击确定按钮</span>alert<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 点击取消按钮</span>alert<span class="token punctuation">.</span><span class="token function">dismiss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>注：如果弹出框不是 js 原生的 alert 弹窗，我们还是按照原来的获取元素的方法。</p><h3 id="4-2-iframe-切换"><a href="#4-2-iframe-切换" class="headerlink" title="4.2 iframe 切换"></a>4.2 iframe 切换</h3><p>有时候我们定位元素的时候，发现怎么都定位不了，这时候你需要查一查你要定位的元素是否在 iframe 里面。</p><p><strong>什么是 iframe？</strong></p><p>iframe 就是 HTML 中，用于网页嵌套网页的，一个网页可以嵌套到另一个网页中，可以嵌套很多层。</p><p>例如：</p><blockquote><p>main.html</p></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>FrameTest<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>id1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>this is main page's div!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maininput<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frameA<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">scrolling</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>no<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">left</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>frame.html<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><blockquote><p>frame.html</p></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>this is a frame!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>div1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>this is iframes div，<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>iframeinput<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>input</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>使用 selenium 操作浏览器时，如果需要操作 iframe 中的元素，首先需要切换到对应的内联框架中。</p><p>selenium 给我们提供了三个重载的方法，进行操作 iframe：</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 方法一:通过 iframe的索引值，在页面中的位置</span>webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 方法二：通过 iframe 的name 或者id</span>webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>nameOrId<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 方法三：通过iframe 对应的webElement        </span>webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span>frameElement<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">testIframe</span><span class="token punctuation">(</span>WebDriver webDriver<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 在 主窗口的时候</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"maininput"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"main input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 此时 没有进入到iframe, 以下语句会报错</span>    <span class="token comment" spellcheck="true">//webDriver.findElement(By.id("iframeinput")).sendKeys("iframe input");</span>    webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span><span class="token string">"frameA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"iframeinput"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"iframe input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 此时没有在主窗口，下面语句会报错</span>    <span class="token comment" spellcheck="true">//webDriver.findElement(By.id("maininput")).sendKeys("main input");</span>    <span class="token comment" spellcheck="true">// 回到主窗口</span>    webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">defaultContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"maininput"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"main input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>注：如果已经切换进入了其中的一个 iframe 中，再想对 iframe 外的元素进行操作，需要切换回到默认的页面中，否则会找不到元素。</p><pre><code>// 切换到默认内容页面webDriver.switchTo().defaultContent();</code></pre><h3 id="4-3-浏览器窗口的切换"><a href="#4-3-浏览器窗口的切换" class="headerlink" title="4.3 浏览器窗口的切换"></a>4.3 浏览器窗口的切换</h3><p> 有时候后在操作浏览器，可能打开了一个新的窗口，这个时候如果要对新窗口的元素进行操作，需要切换到新窗口中去，怎么去切换呢？在 selenium 中有个叫句柄的概念，什么是句柄，简单理解就是浏览器窗口的一个标识，浏览器打开的每个窗口都有唯一的一个标识，也就是句柄，我们可以通过句柄来进行窗口之间的切换，从而来达到我们操作不同窗口的元素。</p><p>WebDriver 中提供了两个 API 来获取窗口的相关句柄：</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 获取当前窗口的句柄</span>String handle <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">getWindowHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 获取所有窗口的句柄，返回一个集合</span>Set<span class="token operator">&lt;</span>String<span class="token operator">></span> handles <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">getWindowHandles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>获取到句柄后，通过对应的方法进行切换：</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 切换到窗口</span>webDriver<span class="token punctuation">.</span>switchTo<span class="token punctuation">.</span><span class="token function">windwo</span><span class="token punctuation">(</span>String handle<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>多窗口之间的切换方法：</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*** 切换窗口的方法* 通过传入一个标题来找到我们需要的窗口。* @param title 窗口的标题*/</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">switchWindow</span><span class="token punctuation">(</span>String title<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    Set<span class="token operator">&lt;</span>String<span class="token operator">></span> handles <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">getWindowHandles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 切换窗口的方式 循环遍历 handles 集合</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>String handle <span class="token operator">:</span> handles<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 判断是哪一个页面的句柄？根据什么来判断？title</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 切换窗口 根据窗口标识来切换</span>        webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><h3 id="4-4-select-下拉框"><a href="#4-4-select-下拉框" class="headerlink" title="4.4 select 下拉框"></a>4.4 select 下拉框</h3><p>如果一个页面元素是一个下拉框（select），对应下拉框的操作，selenium 有专门的类 Select 进行处理，其中包含了单选和多选下拉框的各种操作，如获得所有的选项、选择某一项、取消选中某一项、是否是多选下拉框等。</p><p><strong>Select 类常用的一些方法：</strong></p><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>void deselectAll()</td><td>取消所有选择项，仅对下拉框的多选模式有效，若下拉不支持多选模式，则会抛出异常 UnsupportedOperationException（不支持的操作）</td></tr><tr><td>void deselectByIndex(int index)</td><td>取消指定 index 的选择，index 从零开始，仅对多选模式有效，否则抛出异常 UnsupportedOperationException（不支持的操作）</td></tr><tr><td>void deselectByValue(String value)</td><td>取消 Select 标签中，value 为指定值的选择，仅对多选模式有效，否则抛出异常 UnsupportedOperationException（不支持的操作）</td></tr><tr><td>void deselectByVisibleText(String Text)</td><td>取消项的文字为指定值的项，例如指定值为 Bar，项的 html 为，仅对多选模式有效，单选模式无效，但不会抛出异常</td></tr><tr><td>List getAllSelectedOptions()</td><td>获得所有选中项，单选多选模式均有效，但没有一个被选中时，返回空列表，不会抛出异常</td></tr><tr><td>WebElement getFirstSelectedOption()</td><td>获得第一个被选中的项，单选多选模式均有效，当多选模式下，没有一个被选中时，会抛出NoSuchElementException 异常</td></tr><tr><td>List getOptions()</td><td>获得下拉框的所有项，单选多选模式均有效，当下拉框没有任何项时，返回空列表，不会抛出异常</td></tr><tr><td>boolean isMultiple()</td><td>判断下拉框是否多选模式</td></tr><tr><td>void selectByIndex(int index)</td><td>选中指定 index 的项，单选多选均有效，当 index 超出范围时，抛出 NoSuchElementException 异常</td></tr><tr><td>void selectByValue(String value)</td><td>选中所有 Select 标签中，value 为指定值的所有项，单选多选均有效，当没有适合的项时，抛出NoSuchElementException 异常</td></tr><tr><td>void selectByVisibleText(String text)</td><td>选中所有项的文字为指定值的项，与 deselectByValue 相反，但单选多选模式均有效，当没有适合的项时，抛出NoSuchElementException 异常</td></tr></tbody></table><p><strong>例子：进入 2345.com 首页，点击头部【切换】进行城市切换，我们切换省份为北京。</strong></p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930142017291.png" alt="image-20200930142017291"></p><p>代码编写，这里需要注意下拉选是在一个 iframe 中，需要先切换到这个 iframe 后再操作。</p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 创建驱动</span> WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 打开2345网站</span> webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.2345.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 切换城市</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span><span class="token string">"切换"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 切换到iframe内联框架中</span> webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span><span class="token string">"city_set_ifr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 定位到省份下拉框</span> WebElement province <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"province"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> province<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 创建Select对象</span> Select select <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Select</span><span class="token punctuation">(</span>province<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 根据文本来获取下拉值</span> select<span class="token punctuation">.</span><span class="token function">selectByVisibleText</span><span class="token punctuation">(</span><span class="token string">"B 北京"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="4-5-readonly-属性元素操作"><a href="#4-5-readonly-属性元素操作" class="headerlink" title="4.5 readonly 属性元素操作"></a>4.5 readonly 属性元素操作</h3><p>标签元素如果带有 readonly 属性，表示只读不能进行编辑，如果我们需要操作这样的元素，需要把这个 readonly 属性进行移除后，再进行操作。删除标签属性的话，webdriver 没有对应的 API，我们使用 JavaScript 脚本来进行操作。</p><p><strong>示例：12306 网站购票页面日期。</strong></p><p><img src="https://gitee.com/isKylin/picbed/raw/master/webAutoTest/image-20200930142201483.png" alt="image-20200930142201483"></p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 创建驱动</span>WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 打开12306网站</span>webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.12306.cn/index/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 通过js来移除readonly属性</span>String removeAttr <span class="token operator">=</span> <span class="token string">"document.getElementById('train_date').removeAttribute('readonly');"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 执行js</span><span class="token punctuation">(</span><span class="token punctuation">(</span>JavascriptExecutor<span class="token punctuation">)</span>webDriver<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executeScript</span><span class="token punctuation">(</span>removeAttr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 获取日期日历输入框</span>WebElement train_date <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"train_date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 清除原来的值</span>train_date<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 输入内容</span>train_date<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"2020-03-30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="4-6-日期控件操作"><a href="#4-6-日期控件操作" class="headerlink" title="4.6 日期控件操作"></a>4.6 日期控件操作</h3><p>对于页面中出现时间控件选择时，一般分为两种：</p><p>（1）控件没有限制手动填写的，我们直接使用 sendKeys() 方法进行赋值即可。</p><pre class=" language-java"><code class="language-java">webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"2020-03-30"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>（2）控件限制了手动输入的，只能通过点击控件时间进行输入的，我们就需要使用 js 脚本进行操作了。</p><pre><code>// 获取js执行器JavaScriptExecutor js = (JavaScriptExecutor)webDriver;// 对时间输入框进入赋值String script = &quot;document.getElementById(&#39;xxx&#39;).value=&#39;2020-03-30&#39;;&quot;;// 执行js.executeScript(script);</code></pre><p>注：需要注意的是，不管使用哪种方式进行时间的赋值，一点要注意输入时间的格式是否符合系统的要求。</p><h3 id="4-7-文件上传"><a href="#4-7-文件上传" class="headerlink" title="4.7 文件上传"></a>4.7 文件上传</h3><p>对于通过 input 标签实现的上传功能，可以将其看作是一个输入框，即通过 sendKeys() 指定本地文件路径的方式实现文件上传。</p><blockquote><p>upfile.html</p></blockquote><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html;charset<span class="token punctuation">=</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>upload_file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row-fluid<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>span6 well<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>upload_file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scrip</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>File<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UpFileDemo</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> InterruptedException <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    File file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"./HTMLFile/upfile.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String filePath <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getAbsolutePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//定位上传按钮， 添加本地文件</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"D:\\upload_file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>注：sendKeys 参数为文件的绝对路径，并且上传的文件一点要存在，否则会抛异常。</p><h2 id="五、控制浏览器操作"><a href="#五、控制浏览器操作" class="headerlink" title="五、控制浏览器操作"></a>五、控制浏览器操作</h2><h3 id="5-1-浏览器窗口操作"><a href="#5-1-浏览器窗口操作" class="headerlink" title="5.1 浏览器窗口操作"></a>5.1 浏览器窗口操作</h3><p>WebDriver 给我们提供了一个 Window 对象，专门用于对窗口的设置。</p><p>对象获取方法：</p><pre class=" language-java"><code class="language-java">Window window <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Window 对象的方法有：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>window.maximize()</td><td>将浏览器窗口最大化。</td></tr><tr><td>window.getPosition()</td><td>获取窗口的位置，返回 Point 对象，包含浏览器左上角的坐标位置。通过point.x 和point.y 来获取到。</td></tr><tr><td>window.setPosition(Point)</td><td>指定浏览器窗口左上角的坐标位置，创建一个Point 对象，设置对象的 x 和 y 坐标即可。</td></tr><tr><td>window.getSize()</td><td>获取窗口尺寸（宽和高），返回一个 Dimension 对象，通过该对象调用 getHeight() 和 getWidth() 来获取 高度和宽度。</td></tr><tr><td>window.setSize(Dimension)</td><td>设置窗口大小，创建一个 Dimension 对象，设置对象的高度和宽度。</td></tr></tbody></table><h3 id="5-2-浏览器导航操作"><a href="#5-2-浏览器导航操作" class="headerlink" title="5.2 浏览器导航操作"></a>5.2 浏览器导航操作</h3><p>WebDriver 提供了 Navigation 对象来对浏览器进行导航操作，如：前进、后退、刷新等。</p><p>Navigation 对象获取：</p><pre class=" language-java"><code class="language-java">Navigation navigate <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Navigation 对象提供的方法：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>navigate.to(url)</td><td>跳转到指定url,和 webdriver 使用 get 方法是一样的。</td></tr><tr><td>navigate.refresh()</td><td>刷新当前页面。</td></tr><tr><td>navigate.back()</td><td>浏览器回退操作。</td></tr><tr><td>navigate.forward()</td><td>浏览器前进操作。</td></tr></tbody></table><h2 id="六、模拟鼠标键盘操作"><a href="#六、模拟鼠标键盘操作" class="headerlink" title="六、模拟鼠标键盘操作"></a>六、模拟鼠标键盘操作</h2><h3 id="6-1-模拟鼠标操作"><a href="#6-1-模拟鼠标操作" class="headerlink" title="6.1 模拟鼠标操作"></a>6.1 模拟鼠标操作</h3><p>在 WebDriver 中，关于鼠标的操作我们可以通过 Actions 类来模拟鼠标右击、双击、悬停、拖动等操作。</p><p>Actions 类中鼠标操作常用方法：</p><table><thead><tr><th>方法</th><th>描述</th></tr></thead><tbody><tr><td>contextClick()</td><td>鼠标右击</td></tr><tr><td>clickAndHold(WebElement)</td><td>点击并控制（模拟悬停）</td></tr><tr><td>doubleClick(WebElement)</td><td>鼠标双击</td></tr><tr><td>dragAndDrop(webElement1,webElement2)</td><td>鼠标拖动</td></tr><tr><td>moveToElement(WebElement)</td><td>鼠标移动到某个元素上</td></tr><tr><td>perform()</td><td>执行所有 Actions 中存储的行为</td></tr><tr><td>click()</td><td>鼠标单击（左击）</td></tr></tbody></table><p><strong>示例：百度首页设置悬停下拉菜单。</strong></p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebElement<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>interactions<span class="token punctuation">.</span>Actions<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo04</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 定位元素</span>    WebElement search_setting <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span><span class="token string">"设置"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 创建actions对象</span>    Actions action <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Actions</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 模拟鼠标悬停</span>    action<span class="token punctuation">.</span><span class="token function">clickAndHold</span><span class="token punctuation">(</span>search_setting<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>其他方法使用：</p><pre class=" language-java"><code class="language-java">Actions action <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Actions</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 鼠标右键点击指定的元素</span>action<span class="token punctuation">.</span><span class="token function">contextClick</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 鼠标双击指定的元素</span>action<span class="token punctuation">.</span><span class="token function">doubleClick</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 鼠标移到到指定元素上</span>action<span class="token punctuation">.</span><span class="token function">moveToElement</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 鼠标拖拽动作， 将 source 元素拖放到 target 元素的位置。</span>WebElement source <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>WebElement target <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>action<span class="token punctuation">.</span><span class="token function">dragAndDrop</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 释放鼠标</span>action<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="6-2-模拟键盘操作"><a href="#6-2-模拟键盘操作" class="headerlink" title="6.2 模拟键盘操作"></a>6.2 模拟键盘操作</h3><p>在 selenium 中有个 Keys() 类（枚举类），提供了几乎键盘上所有按键的方法，在使用的过程中，我们可以通过 sendKeys() 方法来模拟键盘的输入，除此之外，我们还可以用它来输入键盘上的按键， 甚至是组合键， 如 Ctrl+A、 Ctrl+C 等。</p><p><strong>以下为常用的键盘操作：</strong></p><ul><li>sendKeys(Keys.BACK_SPACE) 回格键（BackSpace）</li><li>sendKeys(Keys.SPACE) 空格键 (Space)</li><li>sendKeys(Keys.TAB) 制表键 (Tab)</li><li>sendKeys(Keys.ESCAPE) 回退键（Esc）</li><li>sendKeys(Keys.ENTER) 回车键（Enter）</li><li>sendKeys(Keys.CONTROL,’a’) 全选（Ctrl+A）</li><li>sendKeys(Keys.CONTROL,’c’) 复制（Ctrl+C）</li><li>sendKeys(Keys.CONTROL,’x’) 剪切（Ctrl+X）</li><li>sendKeys(Keys.CONTROL,’v’) 粘贴（Ctrl+V）</li><li>sendKeys(Keys.F1) 键盘 F1</li><li>sendKeys(Keys.F12) 键盘 F12</li></ul><p>在使用键盘按键方法前，我们需要先导入 keys 类。</p><pre class=" language-java"><code class="language-java"><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebElement<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>WebDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>ChromeDriver<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>By<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>Keys<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeleniumDemo05</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> InterruptedException <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"webdriver.edge.driver"</span><span class="token punctuation">,</span><span class="token string">"E:\\driver\\MicrosoftWebDriver.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    WebDriver webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EdgeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 定位到对应的元素</span>    WebElement input <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//输入框输入内容</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"seleniumm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//删除多输入的一个 m</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>BACK_SPACE<span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//输入空格键+“教程”</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>SPACE<span class="token punctuation">)</span><span class="token punctuation">;</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"教程"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ctrl+a 全选输入框内容</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ctrl+x 剪切输入框内容</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"x"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ctrl+v 粘贴内容到输入框</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"v"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//通过回车键盘来代替点击操作</span>    input<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre><p>注意：在 Actions 类中也有对应操作键盘的方法，例如：keyUp()、keyDown()等，但是我在实际使用中，并没有生效，不知道为何，从网上资料说是，不能直接对浏览器进行操作，只能对页面的元素进行键盘的模拟操作。</p><h2 id="七、操作-javascript-代码"><a href="#七、操作-javascript-代码" class="headerlink" title="七、操作 javascript 代码"></a>七、操作 javascript 代码</h2><p>虽然 WebDriver 提供了操作浏览器的前进和后退方法，但对于浏览器滚动条并没有提供相应的操作方法。在这种情况下，就可以借助 JavaScript 来控制浏览器的滚动条，WebDriver 提供了 executeScript() 方法来执行 JavaScript 代码。</p><p>用于调整浏览器滚动条位置的 JavaScript 代码如下：</p><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span>左边距<span class="token punctuation">,</span>上边距<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">--</span><span class="token operator">></span>window<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">450</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>window.scrollTo() 方法用于设置浏览器窗口滚动条的水平和垂直位置，方法的第一个参数表示水平的左间距，第二个参数表示垂直的上边距，其代码如下：</p><pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">//设置浏览器窗口大小</span>    webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Dimension</span><span class="token punctuation">(</span><span class="token number">700</span><span class="token punctuation">,</span> <span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//进行百度搜索</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"webdriver api"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">"su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//将页面滚动条拖到底部</span>    <span class="token punctuation">(</span><span class="token punctuation">(</span>JavascriptExecutor<span class="token punctuation">)</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executeScript</span><span class="token punctuation">(</span><span class="token string">"window.scrollTo(100,450);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>通过浏览器打开百度进行搜索，并且提前通过 window().setSize() 方法将浏览器窗口设置为固定宽高显示，目的是让窗口出现水平和垂直滚动条，然后通过 executeScript() 方法执行 JavaScripts 代码来移动滚动条的位置。</p><p><strong>将滚动条滚动到某个区域后停止(页面元素全部加载完成)，如下：</strong></p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">//滚动到某一区域</span><span class="token comment" spellcheck="true">//scrollIntoView(0);  让元素滚动到可视区域的最下方</span><span class="token comment" spellcheck="true">//scrollIntoView();  让元素滚动到可视区域的最上方</span><span class="token comment" spellcheck="true">//JavascriptExecutor javascriptExecutor = (JavascriptExecutor)BrowserUtil.driver;</span><span class="token comment" spellcheck="true">//javascriptExecutor.executeScript("document.getElementById('index_ads').scrollIntoView(0);");</span><span class="token comment" spellcheck="true">//JavaScript的参数传递-selenium和js的交互</span><span class="token comment" spellcheck="true">//1、先去找到这个元素</span>WebElement webElement <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"element"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//2、找到的元素作为参数传入到Js代码中</span>JavascriptExecutor javascriptExecutor <span class="token operator">=</span> <span class="token punctuation">(</span>JavascriptExecutor<span class="token punctuation">)</span>driver<span class="token punctuation">;</span>javascriptExecutor<span class="token punctuation">.</span><span class="token function">executeScript</span><span class="token punctuation">(</span><span class="token string">"arguments[0].scrollIntoView(0)"</span><span class="token punctuation">,</span>webElement<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><strong>页面元素是通过懒加载方式，需要一直进行滚动的</strong></p><pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/*** 滑动列表找元素并且进行点击（懒加载）* @param selectedText  选中元素文本* @param by  正在加载类似元素的定位表达式*/</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">clickElementInList</span><span class="token punctuation">(</span>String selectedText<span class="token punctuation">,</span> By by<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 滑动之前的页面源代码信息</span>    String beforeSource <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 滑动之后的页面源代码信息</span>    String afterSource <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 循环条件</span>    <span class="token comment" spellcheck="true">// 1、找到了元素，跳出循环</span>    <span class="token comment" spellcheck="true">// 2、如果没有找到元素？？？怎么跳出循环</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        WebElement webElement <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 获取页面源代码</span>        beforeSource <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">getPageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 获取js执行器</span>        JavascriptExecutor javascriptExecutor <span class="token operator">=</span> <span class="token punctuation">(</span>JavascriptExecutor<span class="token punctuation">)</span>driver<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 执行js</span>        javascriptExecutor<span class="token punctuation">.</span><span class="token function">executeScript</span><span class="token punctuation">(</span><span class="token string">"arguments[0].scrollIntoView(0);"</span><span class="token punctuation">,</span> webElement<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 如果当前页面有想要的元素，怎么判断是否有？？--getPageSource</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>driver<span class="token punctuation">.</span><span class="token function">getPageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>selectedText<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            driver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token function">linkText</span><span class="token punctuation">(</span>selectedText<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 找到元素退出循环，不再滚动。</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        afterSource <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">getPageSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 页面元素没有变化---滑动到了最底部</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>afterSource<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>beforeSource<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 到达底部，退出。</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Selenium for Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web 自动化测试 </tag>
            
            <tag> 软件测试 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
